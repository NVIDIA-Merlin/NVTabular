<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NVTabular Example Notebooks &mdash; NVTabular 2021 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script >let toggleHintShow = 'Click to show';</script>
        <script >let toggleHintHide = 'Click to hide';</script>
        <script >let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Getting Started with Movielens" href="getting-started-movielens/index.html" />
    <link rel="prev" title="Accelerated Training with HugeCTR" href="../training/hugectr.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> NVTabular
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_features.html">Core Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../training/index.html">Accelerated Training</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example Notebooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#structure">Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#available-example-notebooks">Available Example Notebooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#getting-started-with-movielens">1. Getting Started with MovieLens</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-ops-with-outbrain">2. Advanced Ops with Outbrain</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scaling-large-datasets-with-criteo">3. Scaling Large Datasets with Criteo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multi-gpu-with-movielens">4. Multi-GPU with MovieLens</a></li>
<li class="toctree-l3"><a class="reference internal" href="#winning-solution-of-the-recsys2020-competition">5. Winning Solution of the RecSys2020 Competition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#applying-the-techniques-to-other-tabular-problems-with-rossmann">6. Applying the Techniques to other Tabular Problems with Rossmann</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-example-notebooks">Running the Example Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting-started-movielens/index.html">Getting Started with MovieLens</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced-ops-outbrain/index.html">Advanced Ops with Outbrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="scaling-criteo/index.html">Scaling to Large Datasets with Criteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="tabular-data-rossmann/index.html">Applying Techniques to Rossmann Stores Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi-gpu-movielens/index.html">Multi-GPU Example Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="winning-solution-recsys2020-twitter/01-02-04-Download-Convert-ETL-with-NVTabular-Training-with-XGBoost.html">Winning Solution of the RecSys2020 Competition</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/index.html">Additional Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NVTabular</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>NVTabular Example Notebooks</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="tex2jax_ignore mathjax_ignore section" id="nvtabular-example-notebooks">
<h1>NVTabular Example Notebooks<a class="headerlink" href="#nvtabular-example-notebooks" title="Permalink to this headline"></a></h1>
<p>We have created a collection of Jupyter notebooks based on different datasets. These example notebooks demonstrate how to use NVTabular with TensorFlow, PyTorch, and <a class="reference external" href="https://github.com/NVIDIA/HugeCTR">HugeCTR</a>. Each example provides additional information about NVTabular’s features.</p>
<p>If you’d like to create a full conda environment to run the example notebooks, do the following:</p>
<ol>
<li><p>Use the <a class="reference external" href="https://github.com/NVIDIA/NVTabular/tree/main/conda/environments">environment files</a> that have been provided to install the CUDA Toolkit (11.0 or 11.2).</p></li>
<li><p>Clone the NVTabular repo and run the following commands from the root directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda env create -f<span class="o">=</span>conda/environments/nvtabular_dev_cuda11.2.yml
conda activate nvtabular_dev_11.2
python -m ipykernel install --user --name<span class="o">=</span>nvt
pip install -e .
jupyter notebook
</pre></div>
</div>
<p>When opening a notebook, be sure to select <code class="docutils literal notranslate"><span class="pre">nvt</span></code> from the <code class="docutils literal notranslate"><span class="pre">Kernel-&gt;Change</span> <span class="pre">Kernel</span></code> menu.</p>
</li>
</ol>
<div class="section" id="structure">
<h2>Structure<a class="headerlink" href="#structure" title="Permalink to this headline"></a></h2>
<p>The example notebooks are structured as follows and should be reviewed in this order:</p>
<ul class="simple">
<li><p>01-Download-Convert.ipynb: Demonstrates how to download the dataset and convert it into the correct format so that it can be consumed.</p></li>
<li><p>02-ETL-with-NVTabular.ipynb: Demonstrates how to execute the preprocessing and feature engineering pipeline (ETL) with NVTabular on the GPU.</p></li>
<li><p>03-Training-with-TF.ipynb: Demonstrates how to train a model with TensorFlow based on the ETL output.</p></li>
<li><p>03-Training-with-PyTorch.ipynb: Demonstrates how to train a model with PyTorch based on the ETL output.</p></li>
<li><p>03-Training-with-HugeCTR.ipynb: Demonstrates how to train a model with HugeCTR based on the ETL output.</p></li>
</ul>
</div>
<div class="section" id="available-example-notebooks">
<h2>Available Example Notebooks<a class="headerlink" href="#available-example-notebooks" title="Permalink to this headline"></a></h2>
<div class="section" id="getting-started-with-movielens">
<h3>1. <a class="reference external" href="https://github.com/NVIDIA/NVTabular/tree/main/examples/getting-started-movielens">Getting Started with MovieLens</a><a class="headerlink" href="#getting-started-with-movielens" title="Permalink to this headline"></a></h3>
<p>The MovieLens25M is a popular dataset for recommender systems and is used in academic publications. Most users are familiar with this dataset, so this example notebook is focusing primarily on the basic concepts of NVTabular, which includes:</p>
<ul class="simple">
<li><p>Learning NVTabular with NVTabular’s high-level API</p></li>
<li><p>Using single-hot/multi-hot categorical input features with NVTabular</p></li>
<li><p>Using the NVTabular dataloader with the TensorFlow Keras model</p></li>
<li><p>Using the NVTabular dataloader with PyTorch</p></li>
</ul>
</div>
<div class="section" id="advanced-ops-with-outbrain">
<h3>2. <a class="reference external" href="https://github.com/NVIDIA/NVTabular/tree/main/examples/advanced-ops-outbrain">Advanced Ops with Outbrain</a><a class="headerlink" href="#advanced-ops-with-outbrain" title="Permalink to this headline"></a></h3>
<p>The <a class="reference external" href="https://www.kaggle.com/c/outbrain-click-prediction">Outbrain dataset</a> is based on a Kaggle Competition in which Kagglers were challenged to predict which ads and other forms of sponsored content that their global users would click. This example notebook demonstrates how to use the available NVTabular operators, write a custom operator, and train a Wide&amp;Deep model with the NVTabular dataloader in TensorFlow.</p>
</div>
<div class="section" id="scaling-large-datasets-with-criteo">
<h3>3. <a class="reference external" href="https://github.com/NVIDIA/NVTabular/tree/main/examples/scaling-criteo">Scaling Large Datasets with Criteo</a><a class="headerlink" href="#scaling-large-datasets-with-criteo" title="Permalink to this headline"></a></h3>
<p><a class="reference external" href="https://ailab.criteo.com/download-criteo-1tb-click-logs-dataset/">Criteo</a> provides the largest publicly available dataset for recommender systems with a size of 1TB of uncompressed click logs that contain 4 billion examples. This example notebook demonstrates how to scale NVTabular, use multiple GPUs and multiple nodes with NVTabular for ETL, and train a recommender system model with the NVTabular dataloader for PyTorch.</p>
</div>
<div class="section" id="multi-gpu-with-movielens">
<h3>4. <a class="reference external" href="https://github.com/NVIDIA/NVTabular/tree/main/examples/multi-gpu-movielens">Multi-GPU with MovieLens</a><a class="headerlink" href="#multi-gpu-with-movielens" title="Permalink to this headline"></a></h3>
<p>In the Getting Started with MovieLens example, we explain the fundamentals of NVTabular and its dataloader, HugeCTR, and Triton Inference. With this example, we revisit the same dataset but demonstrate how to perform multi-GPU training with the NVTabular dataloader in TensorFlow.</p>
</div>
<div class="section" id="winning-solution-of-the-recsys2020-competition">
<h3>5. <a class="reference external" href="https://github.com/NVIDIA/NVTabular/tree/main/examples/winning-solution-recsys2020-twitter">Winning Solution of the RecSys2020 Competition</a><a class="headerlink" href="#winning-solution-of-the-recsys2020-competition" title="Permalink to this headline"></a></h3>
<p>Twitter provided a dataset for the <a class="reference external" href="http://www.recsyschallenge.com/2020/">RecSys2020 challenge</a>. The goal was to predict user engagement based on 200M user-tweet pairs. This example notebook demonstrates how to use NVTabular’s available operators for feature engineering and train a XGBoost model on the GPU with dask.</p>
</div>
<div class="section" id="applying-the-techniques-to-other-tabular-problems-with-rossmann">
<h3>6. <a class="reference external" href="https://github.com/NVIDIA/NVTabular/tree/main/examples/tabular-data-rossmann">Applying the Techniques to other Tabular Problems with Rossmann</a><a class="headerlink" href="#applying-the-techniques-to-other-tabular-problems-with-rossmann" title="Permalink to this headline"></a></h3>
<p>Rossmann operates over 3,000 drug stores across seven European countries. Historical sales data for 1,115 Rossmann stores are provided. The goal is to forecast the <strong>Sales</strong> column for the test set. Kaggle hosted it as a <a class="reference external" href="https://www.kaggle.com/c/rossmann-store-sales/overview">competition</a>.</p>
</div>
</div>
<div class="section" id="running-the-example-notebooks">
<h2>Running the Example Notebooks<a class="headerlink" href="#running-the-example-notebooks" title="Permalink to this headline"></a></h2>
<p>You can run the example notebooks by <a class="reference external" href="https://github.com/NVIDIA/NVTabular#installation">installing NVTabular</a> and other required libraries. Alternatively, Docker containers are available on <a class="reference external" href="http://ngc.nvidia.com/catalog/containers/">http://ngc.nvidia.com/catalog/containers/</a> with pre-installed versions. Depending on which example you want to run, you should use any one of these Docker containers:</p>
<ul class="simple">
<li><p>Merlin-Tensorflow-Training (contains NVTabular with TensorFlow)</p></li>
<li><p>Merlin-Pytorch-Training (contains NVTabular with PyTorch)</p></li>
<li><p>Merlin-Training (contains NVTabular with HugeCTR)</p></li>
<li><p>Merlin-Inference (contains NVTabular with TensorFlow and Triton Inference support)</p></li>
</ul>
<p>To run the example notebooks using Docker containers, do the following:</p>
<ol>
<li><p>Pull the container by running the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">--</span><span class="n">runtime</span><span class="o">=</span><span class="n">nvidia</span> <span class="o">--</span><span class="n">rm</span> <span class="o">-</span><span class="n">it</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8888</span><span class="p">:</span><span class="mi">8888</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8797</span><span class="p">:</span><span class="mi">8787</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8796</span><span class="p">:</span><span class="mi">8786</span> <span class="o">--</span><span class="n">ipc</span><span class="o">=</span><span class="n">host</span> <span class="o">&lt;</span><span class="n">docker</span> <span class="n">container</span><span class="o">&gt;</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span>
</pre></div>
</div>
<p><strong>NOTES</strong>:</p>
<ul class="simple">
<li><p>If you are running on Docker version 19 and higher, change <code class="docutils literal notranslate"><span class="pre">--runtime=nvidia</span></code> to <code class="docutils literal notranslate"><span class="pre">--gpus</span> <span class="pre">all</span></code>.</p></li>
<li><p>If you are running <code class="docutils literal notranslate"><span class="pre">Getting</span> <span class="pre">Started</span> <span class="pre">with</span> <span class="pre">MovieLens</span></code> , <code class="docutils literal notranslate"><span class="pre">Advanced</span> <span class="pre">Ops</span> <span class="pre">with</span> <span class="pre">Outbrain</span></code> or <code class="docutils literal notranslate"><span class="pre">Tabular</span> <span class="pre">Problems</span> <span class="pre">with</span> <span class="pre">Rossmann</span></code> example notebooks you need to add <code class="docutils literal notranslate"><span class="pre">-v</span> <span class="pre">${PWD}:/root/</span></code> to the docker script above. Here <code class="docutils literal notranslate"><span class="pre">PWD</span></code> is a local directory in your system, and this very same directory should also be mounted to the <code class="docutils literal notranslate"><span class="pre">merlin-inference</span></code>container if you would like to run the inference example. Please follow the <code class="docutils literal notranslate"><span class="pre">start</span> <span class="pre">and</span> <span class="pre">launch</span> <span class="pre">triton</span> <span class="pre">server</span></code> instructions given in the inference notebooks.</p></li>
<li><p>If you are running <code class="docutils literal notranslate"><span class="pre">Training-with-HugeCTR</span></code> notebooks, please add <code class="docutils literal notranslate"><span class="pre">--cap-add</span> <span class="pre">SYS_NICE</span></code> to <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span></code> command to suppress the <code class="docutils literal notranslate"><span class="pre">set_mempolicy:</span> <span class="pre">Operation</span> <span class="pre">not</span> <span class="pre">permitted</span></code> warnings.</p></li>
</ul>
</li>
</ol>
<p>The container will open a shell when the run command execution is completed. You will have to start JupyterLab on the Docker container. It should look similar to this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="o">@</span><span class="mi">2</span><span class="n">efa5b50b909</span><span class="p">:</span>
</pre></div>
</div>
<ol>
<li><p>Install jupyter-lab with <code class="docutils literal notranslate"><span class="pre">pip</span></code> by running the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">jupyterlab</span>
</pre></div>
</div>
<p>For more information, see <a class="reference external" href="https://jupyterlab.readthedocs.io/en/stable/getting_started/installation.html">Installation Guide</a>.</p>
</li>
<li><p>Start the jupyter-lab server by running the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupyter</span><span class="o">-</span><span class="n">lab</span> <span class="o">--</span><span class="n">allow</span><span class="o">-</span><span class="n">root</span> <span class="o">--</span><span class="n">ip</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span> <span class="o">--</span><span class="n">NotebookApp</span><span class="o">.</span><span class="n">token</span><span class="o">=</span><span class="s1">&#39;&lt;password&gt;&#39;</span>
</pre></div>
</div>
</li>
<li><p>Open any browser to access the jupyter-lab server using <MachineIP>:8888.</p></li>
<li><p>Once in the server, navigate to the <code class="docutils literal notranslate"><span class="pre">/nvtabular/</span></code> directory and try out the examples.</p></li>
</ol>
</div>
<div class="toctree-wrapper compound">
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../training/hugectr.html" class="btn btn-neutral float-left" title="Accelerated Training with HugeCTR" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="getting-started-movielens/index.html" class="btn btn-neutral float-right" title="Getting Started with Movielens" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, NVIDIA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v1.0.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="../../v0.10.0/index.html">v0.10.0</a></dd>
      <dd><a href="../../v0.11.0/index.html">v0.11.0</a></dd>
      <dd><a href="../../v0.9.0/index.html">v0.9.0</a></dd>
      <dd><a href="index.html">v1.0.0</a></dd>
      <dd><a href="../../v1.1.0/index.html">v1.1.0</a></dd>
      <dd><a href="../../v1.1.1/index.html">v1.1.1</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="../../main/index.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>